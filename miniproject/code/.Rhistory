}
Stat_Gromp[i,"Gromp_AICc"]<-min(test_Gromp$AICc[!is.na(test_Gromp$AICc)])
Stat_Gromp[i,"Gromp_BIC"]<- min(test_Gromp$BIC[!is.na(test_Gromp$BIC)])
Stat_Gromp[i,"Gromp_AIC"]<-min(test_Gromp$AIC[!is.na(test_Gromp$AIC)])
Stat_Baran[i,"Baran_AICc"]<-min(test_Baran$AICc[!is.na(test_Baran$AICc)])
Stat_Baran[i,"Baran_BIC"]<- min(test_Baran$BIC[!is.na(test_Baran$BIC)])
Stat_Baran[i,"Baran_AIC"]<-min(test_Baran$AIC[!is.na(test_Baran$AIC)])
},
error = function(e){
message('Caught an error!')
print(e)
},
warning = function(w){
message('Caught an warning!')
print(w)
},
finally = {
message('All done, quitting.')
})
}
toc()
# tables
Compare_AIC<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AIC"],
Gromp_AICc = Stat_Gromp["Gromp_AIC"],
Barn_AICc = Stat_Baran["Baran_AIC"])
Compare_AICc<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AICc"],
Gromp_AICc = Stat_Gromp["Gromp_AICc"],
Barn_AICc = Stat_Baran["Baran_AICc"])
Compare_BIC<-data.frame(Subset =  1:max(DF$ID),
Poly_BIC = Stat_Poly["Poly_BIC"],
Gromp_BIC = Stat_Gromp["Gromp_BIC"],
Barn_BIC = Stat_Baran["Baran_BIC"])
Best_model<-data.frame(Subset = 1:max(DF$ID),
BestModelAIC = "NA",
AIC ="NA",
BestModelAICc = "NA",
AICc ="NA",
BestModelBIC = "NA",
BIC="NA")
for (i in 1:max(DF$ID)) {
if (Compare_AIC[i, "Gromp_AIC"]  == 0 && Compare_AIC[i, "Baran_AIC"] == 0){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
} else if (Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Gromp_AIC"] && Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
}  else if (Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Gromp_AIC"]
Best_model[i,"BestModelAIC"] <- "Grompertz"
} else if (Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Gromp_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Baran_AIC"]
Best_model[i,"BestModelAIC"] <- "Baranyi"
}
if (Compare_AICc[i, "Gromp_AICc"]  == 0 && Compare_AICc[i, "Baran_AICc"] == 0){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
} else if (Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Gromp_AICc"] && Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
}  else if (Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Gromp_AICc"]
Best_model[i,"BestModelAICc"] <- "Grompertz"
} else if (Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Gromp_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Baran_AICc"]
Best_model[i,"BestModelAICc"] <- "Baranyi"
}
if (Compare_BIC[i, "Gromp_BIC"] == 0 && Compare_BIC[i, "Baran_BIC"] == 0 ){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if(Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Gromp_BIC"] && Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if (Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Gromp_BIC"]
Best_model[i,"BestModelBIC"] <- "Grompertz"
} else if (Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Gromp_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Baran_BIC"]
Best_model[i,"BestModelBIC"] <- "Baranyi"
}
}
# Stats Comparison #
Compare_AIC<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AIC"],
Gromp_AICc = Stat_Gromp["Gromp_AIC"],
Barn_AICc = Stat_Baran["Baran_AIC"])
Compare_AICc<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AICc"],
Gromp_AICc = Stat_Gromp["Gromp_AICc"],
Barn_AICc = Stat_Baran["Baran_AICc"])
Compare_BIC<-data.frame(Subset =  1:max(DF$ID),
Poly_BIC = Stat_Poly["Poly_BIC"],
Gromp_BIC = Stat_Gromp["Gromp_BIC"],
Barn_BIC = Stat_Baran["Baran_BIC"])
Best_model<-data.frame(Subset = 1:max(DF$ID),
BestModelAIC = "NA",
AIC ="NA",
BestModelAICc = "NA",
AICc ="NA",
BestModelBIC = "NA",
BIC="NA")
Stat_Gromp[i,"Gromp_AICc"]<-min(test_Gromp$AICc[!is.na(test_Gromp$AICc)])
Stat_Gromp[i,"Gromp_BIC"]<- min(test_Gromp$BIC[!is.na(test_Gromp$BIC)])
Stat_Gromp[i,"Gromp_AIC"]<-min(test_Gromp$AIC[!is.na(test_Gromp$AIC)])
Stat_Baran[i,"Baran_AICc"]<-min(test_Baran$AICc[!is.na(test_Baran$AICc)])
Stat_Baran[i,"Baran_BIC"]<- min(test_Baran$BIC[!is.na(test_Baran$BIC)])
Stat_Baran[i,"Baran_AIC"]<-min(test_Baran$AIC[!is.na(test_Baran$AIC)])
},
error = function(e){
message('Caught an error!')
print(e)
},
warning = function(w){
message('Caught an warning!')
print(w)
},
finally = {
message('All done, quitting.')
})
}
for (i in 1:max(DF$ID)) {
if (Compare_AIC[i, "Gromp_AIC"]  == 0 && Compare_AIC[i, "Baran_AIC"] == 0){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
} else if (Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Gromp_AIC"] && Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
}  else if (Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Gromp_AIC"]
Best_model[i,"BestModelAIC"] <- "Grompertz"
} else if (Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Gromp_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Baran_AIC"]
Best_model[i,"BestModelAIC"] <- "Baranyi"
}
if (Compare_AICc[i, "Gromp_AICc"]  == 0 && Compare_AICc[i, "Baran_AICc"] == 0){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
} else if (Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Gromp_AICc"] && Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
}  else if (Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Gromp_AICc"]
Best_model[i,"BestModelAICc"] <- "Grompertz"
} else if (Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Gromp_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Baran_AICc"]
Best_model[i,"BestModelAICc"] <- "Baranyi"
}
if (Compare_BIC[i, "Gromp_BIC"] == 0 && Compare_BIC[i, "Baran_BIC"] == 0 ){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if(Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Gromp_BIC"] && Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if (Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Gromp_BIC"]
Best_model[i,"BestModelBIC"] <- "Grompertz"
} else if (Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Gromp_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Baran_BIC"]
Best_model[i,"BestModelBIC"] <- "Baranyi"
}
}
}
write.csv(Best_model, "/home/frcovell/CMEECourseWork/miniproject/result/BestModel.csv")
# tables
Compare_AIC<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AIC"],
Gromp_AICc = Stat_Gromp["Gromp_AIC"],
Barn_AICc = Stat_Baran["Baran_AIC"])
Compare_AICc<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AICc"],
Gromp_AICc = Stat_Gromp["Gromp_AICc"],
Barn_AICc = Stat_Baran["Baran_AICc"])
Compare_BIC<-data.frame(Subset =  1:max(DF$ID),
Poly_BIC = Stat_Poly["Poly_BIC"],
Gromp_BIC = Stat_Gromp["Gromp_BIC"],
Barn_BIC = Stat_Baran["Baran_BIC"])
Best_model<-data.frame(Subset = 1:max(DF$ID),
BestModelAIC = "NA",
AIC ="NA",
BestModelAICc = "NA",
AICc ="NA",
BestModelBIC = "NA",
BIC="NA")
for (i in 1:max(DF$ID)) {
if (Compare_AIC[i, "Gromp_AIC"]  == 0 && Compare_AIC[i, "Baran_AIC"] == 0){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
} else if (Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Gromp_AIC"] && Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
}  else if (Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Gromp_AIC"]
Best_model[i,"BestModelAIC"] <- "Grompertz"
} else if (Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Gromp_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Baran_AIC"]
Best_model[i,"BestModelAIC"] <- "Baranyi"
}
if (Compare_AICc[i, "Gromp_AICc"]  == 0 && Compare_AICc[i, "Baran_AICc"] == 0){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
} else if (Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Gromp_AICc"] && Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
}  else if (Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Gromp_AICc"]
Best_model[i,"BestModelAICc"] <- "Grompertz"
} else if (Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Gromp_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Baran_AICc"]
Best_model[i,"BestModelAICc"] <- "Baranyi"
}
if (Compare_BIC[i, "Gromp_BIC"] == 0 && Compare_BIC[i, "Baran_BIC"] == 0 ){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if(Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Gromp_BIC"] && Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if (Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Gromp_BIC"]
Best_model[i,"BestModelBIC"] <- "Grompertz"
} else if (Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Gromp_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Baran_BIC"]
Best_model[i,"BestModelBIC"] <- "Baranyi"
}
}
# tables
Compare_AIC<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AIC"],
Gromp_AICc = Stat_Gromp["Gromp_AIC"],
Barn_AICc = Stat_Baran["Baran_AIC"])
Compare_AICc<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AICc"],
Gromp_AICc = Stat_Gromp["Gromp_AICc"],
Barn_AICc = Stat_Baran["Baran_AICc"])
Compare_BIC<-data.frame(Subset =  1:max(DF$ID),
Poly_BIC = Stat_Poly["Poly_BIC"],
Gromp_BIC = Stat_Gromp["Gromp_BIC"],
Barn_BIC = Stat_Baran["Baran_BIC"])
Best_model<-data.frame(Subset = 1:max(DF$ID),
BestModelAIC = "NA",
AIC ="NA",
BestModelAICc = "NA",
AICc ="NA",
BestModelBIC = "NA",
BIC="NA")
for (i in 1:max(DF$ID)) {
if (Compare_AIC[i, "Gromp_AIC"]  == 0 && Compare_AIC[i, "Baran_AIC"] == 0){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
} else if (Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Gromp_AIC"] && Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
}  else if (Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Gromp_AIC"]
Best_model[i,"BestModelAIC"] <- "Grompertz"
} else if (Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Gromp_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Baran_AIC"]
Best_model[i,"BestModelAIC"] <- "Baranyi"
}
if (Compare_AICc[i, "Gromp_AICc"]  == 0 && Compare_AICc[i, "Baran_AICc"] == 0){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
} else if (Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Gromp_AICc"] && Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
}  else if (Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Gromp_AICc"]
Best_model[i,"BestModelAICc"] <- "Grompertz"
} else if (Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Gromp_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Baran_AICc"]
Best_model[i,"BestModelAICc"] <- "Baranyi"
}
if (Compare_BIC[i, "Gromp_BIC"] == 0 && Compare_BIC[i, "Baran_BIC"] == 0 ){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if(Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Gromp_BIC"] && Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if (Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Gromp_BIC"]
Best_model[i,"BestModelBIC"] <- "Grompertz"
} else if (Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Gromp_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Baran_BIC"]
Best_model[i,"BestModelBIC"] <- "Baranyi"
}
}
# Stats Comparison #
Compare_AIC<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AIC"],
Gromp_AICc = Stat_Gromp["Gromp_AIC"],
Barn_AICc = Stat_Baran["Baran_AIC"])
Compare_AICc<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AICc"],
Gromp_AICc = Stat_Gromp["Gromp_AICc"],
Barn_AICc = Stat_Baran["Baran_AICc"])
Compare_BIC<-data.frame(Subset =  1:max(DF$ID),
Poly_BIC = Stat_Poly["Poly_BIC"],
Gromp_BIC = Stat_Gromp["Gromp_BIC"],
Barn_BIC = Stat_Baran["Baran_BIC"])
Best_model<-data.frame(Subset = 1:max(DF$ID),
BestModelAIC = "NA",
AIC ="NA",
BestModelAICc = "NA",
AICc ="NA",
BestModelBIC = "NA",
BIC="NA")
for (i in 1:max(DF$ID)) {
if (Compare_AIC[i, "Gromp_AIC"]  == 0 && Compare_AIC[i, "Baran_AIC"] == 0){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
} else if (Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Gromp_AIC"] && Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
}  else if (Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Gromp_AIC"]
Best_model[i,"BestModelAIC"] <- "Grompertz"
} else if (Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Gromp_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Baran_AIC"]
Best_model[i,"BestModelAIC"] <- "Baranyi"
}
if (Compare_AICc[i, "Gromp_AICc"]  == 0 && Compare_AICc[i, "Baran_AICc"] == 0){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
} else if (Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Gromp_AICc"] && Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
}  else if (Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Gromp_AICc"]
Best_model[i,"BestModelAICc"] <- "Grompertz"
} else if (Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Gromp_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Baran_AICc"]
Best_model[i,"BestModelAICc"] <- "Baranyi"
}
if (Compare_BIC[i, "Gromp_BIC"] == 0 && Compare_BIC[i, "Baran_BIC"] == 0 ){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if(Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Gromp_BIC"] && Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if (Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Gromp_BIC"]
Best_model[i,"BestModelBIC"] <- "Grompertz"
} else if (Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Gromp_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Baran_BIC"]
Best_model[i,"BestModelBIC"] <- "Baranyi"
}
}
write.csv(Best_model, "/home/frcovell/CMEECourseWork/miniproject/result/BestModel.csv")
#Imports
require(viridis)
rm(list=ls())
DF <- read.csv("../data/ModGrowthData.csv")
BestModel <- read.csv("../reslut/BestModel.csv")
getwd()
BestModel <- read.csv("../result/BestModel.csv")
TempData <- data.frame(Subset = 1:max(DF$ID),
Temp = 0,
Bestmodel = Bestmodel$BestModelAIC,
stringsAsFactors = F)
for (i in 1:max(DF$ID)) {
d <- DF[ which(DF$ID == i),]
LetsGO[i,"Temp"] <- d$Temp[1]
}
TempPlot <- ggplot(data = LetsGO) +
aes(x = Bestmodel, fill = Temp)+
geom_bar()+
scale_fill_viridis(discrete = T)+
theme_minimal()+
theme(legend.position = 'bottom')+
xlab('Model')+
ylab('Count')
TempPlot
TempPlot <- ggplot(data = TempData) +
aes(x = Bestmodel, fill = Temp)+
geom_bar()+
scale_fill_viridis(discrete = T)+
theme_minimal()+
theme(legend.position = 'bottom')+
xlab('Model')+
ylab('Count')
TempData <- data.frame(Subset = 1:max(DF$ID),
Temp = 0,
Bestmodel = BestModel$,
stringsAsFactors = F)
Best_Model <- read.csv("../result/BestModel.csv")
TempData <- data.frame(Subset = 1:max(DF$ID),
Temp = 0,
Bestmodel = Best_Model$BestModelAIC,
stringsAsFactors = F)
for (i in 1:max(DF$ID)) {
d <- DF[ which(DF$ID == i),]
LetsGO[i,"Temp"] <- d$Temp[1]
}
TempPlot <- ggplot(data = TempData) +
aes(x = Bestmodel, fill = Temp)+
geom_bar()+
scale_fill_viridis(discrete = T)+
theme_minimal()+
theme(legend.position = 'bottom')+
xlab('Model')+
ylab('Count')
TempPlot
TempPlot <- ggplot(data = as.factor(TempData)) +
aes(x = Bestmodel, fill = Temp)+
geom_bar()+
scale_fill_viridis(discrete = T)+
theme_minimal()+
theme(legend.position = 'bottom')+
xlab('Model')+
ylab('Count')
LetsGO <- data.frame(Subset = 1:max(DF$ID),
Temp = 0,
Bestmodel = Best_model$BestModelAIC,
stringsAsFactors = F)
for (i in 1:max(DF$ID)) {
d <- DF[ which(DF$ID == i),]
LetsGO[i,"Temp"] <- d$Temp[1]
}
LetsGO["Temp"]
TempPlot <- ggplot(data = LetsGO) +
aes(x = Bestmodel, fill = Temp)+
geom_bar()+
scale_fill_viridis(discrete = T)+
theme_minimal()+
theme(legend.position = 'bottom')+
xlab('Model')+
ylab('Count')
LetsGO <- data.frame(Subset = 1:max(DF$ID),
Temp = 0,
Bestmodel = Best_model$BestModelAIC,
stringsAsFactors = F)
# tables
Compare_AIC<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AIC"],
Gromp_AICc = Stat_Gromp["Gromp_AIC"],
Barn_AICc = Stat_Baran["Baran_AIC"])
Compare_AICc<-data.frame(Subset =  1:max(DF$ID),
Poly_AICc = Stat_Poly["Poly_AICc"],
Gromp_AICc = Stat_Gromp["Gromp_AICc"],
Barn_AICc = Stat_Baran["Baran_AICc"])
Compare_BIC<-data.frame(Subset =  1:max(DF$ID),
Poly_BIC = Stat_Poly["Poly_BIC"],
Gromp_BIC = Stat_Gromp["Gromp_BIC"],
Barn_BIC = Stat_Baran["Baran_BIC"])
Best_model<-data.frame(Subset = 1:max(DF$ID),
BestModelAIC = "NA",
AIC ="NA",
BestModelAICc = "NA",
AICc ="NA",
BestModelBIC = "NA",
BIC="NA")
for (i in 1:max(DF$ID)) {
if (Compare_AIC[i, "Gromp_AIC"]  == 0 && Compare_AIC[i, "Baran_AIC"] == 0){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
} else if (Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Gromp_AIC"] && Compare_AIC[i, "Poly_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Poly_AIC"]
Best_model[i,"BestModelAIC"] <- "Cubic Poly"
}  else if (Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Gromp_AIC"] < Compare_AIC[i, "Baran_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Gromp_AIC"]
Best_model[i,"BestModelAIC"] <- "Grompertz"
} else if (Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Poly_AIC"] && Compare_AIC[i, "Baran_AIC"] < Compare_AIC[i, "Gromp_AIC"]){
Best_model[i,"AIC"]<- Compare_AIC[i, "Baran_AIC"]
Best_model[i,"BestModelAIC"] <- "Baranyi"
}
if (Compare_AICc[i, "Gromp_AICc"]  == 0 && Compare_AICc[i, "Baran_AICc"] == 0){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
} else if (Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Gromp_AICc"] && Compare_AICc[i, "Poly_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Poly_AICc"]
Best_model[i,"BestModelAICc"] <- "Cubic Poly"
}  else if (Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Gromp_AICc"] < Compare_AICc[i, "Baran_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Gromp_AICc"]
Best_model[i,"BestModelAICc"] <- "Grompertz"
} else if (Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Poly_AICc"] && Compare_AICc[i, "Baran_AICc"] < Compare_AICc[i, "Gromp_AICc"]){
Best_model[i,"AICc"]<- Compare_AICc[i, "Baran_AICc"]
Best_model[i,"BestModelAICc"] <- "Baranyi"
}
if (Compare_BIC[i, "Gromp_BIC"] == 0 && Compare_BIC[i, "Baran_BIC"] == 0 ){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if(Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Gromp_BIC"] && Compare_BIC[i, "Poly_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Poly_BIC"]
Best_model[i,"BestModelBIC"] <- "Cubic Poly"
} else if (Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Gromp_BIC"] < Compare_BIC[i, "Baran_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Gromp_BIC"]
Best_model[i,"BestModelBIC"] <- "Grompertz"
} else if (Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Poly_BIC"] && Compare_BIC[i, "Baran_BIC"] < Compare_BIC[i, "Gromp_BIC"]){
Best_model[i,"BIC"]<- Compare_BIC[i, "Baran_BIC"]
Best_model[i,"BestModelBIC"] <- "Baranyi"
}
}
View(Best_model)
View(Best_Model)
View(Best_model)
LetsGO <- data.frame(Subset = 1:max(DF$ID),
Temp = 0,
Bestmodel = Best_model$BestModelAIC,
stringsAsFactors = F)
for (i in 1:max(DF$ID)) {
d <- DF[ which(DF$ID == i),]
LetsGO[i,"Temp"] <- d$Temp[1]
}
TempPlot <- ggplot(data = LetsGO) +
aes(x = Bestmodel, fill = Temp)+
geom_bar()+
scale_fill_viridis(discrete = T)+
theme_minimal()+
theme(legend.position = 'bottom')+
xlab('Model')+
ylab('Count')
TempPlot
